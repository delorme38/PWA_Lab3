<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <p> Désolé cette ressource n'est pas disponible hors-ligne</p>
    <!-- <button onclick="meNotifier()">Activer les notifications</button> -->
    <button onclick="enregistrerTagBgSync()">Me notifier quand la connexion reviens</button>

    <script>
    // // Web-Push
    //     // Public base64 to Uint
    //     function urlBase64ToUint8Array(base64String) {
    //       var padding = '='.repeat((4 - base64String.length % 4) % 4);
    //       var base64 = (base64String + padding)
    //           .replace(/\-/g, '+')
    //           .replace(/_/g, '/');
        
    //       var rawData = window.atob(base64);
    //       var outputArray = new Uint8Array(rawData.length);
        
    //       for (var i = 0; i < rawData.length; ++i) {
    //           outputArray[i] = rawData.charCodeAt(i);
    //       }
    //       return outputArray;
    //     }
        
        
    //     function subscribeUser() {
    //       if ('serviceWorker' in navigator) {
    //           navigator.serviceWorker.ready.then(function (reg) {
        
    //               reg.pushManager.subscribe({
    //                   userVisibleOnly: true,
    //                   applicationServerKey: urlBase64ToUint8Array(
    //                       'BEbfcTLdFNJvysvhu9go33qFwE-K45_rfVigcFvQ2fYpAlRzWFM3iziv0b_XeSgMP6haBneLHMfO7rTaPCHzUbo'
    //                   )
    //               }).then(function (pushSubscription) {
    //                   console.log('Received PushSubscription: ', JSON.stringify(pushSubscription));
    //               }).catch(function (e) {
    //                   if (Notification.permission === 'denied') {
    //                       console.warn('Permission for notifications was denied');
    //                   } else {
    //                       console.error('Unable to subscribe to push', e);
    //                   }
    //               });
    //           })
    //       }
    //     }
        
        function enregistrerTagBgSync() {
            Notification.requestPermission().then(function (result) {
              console.log("permission donnée");
              console.log(result);
          });
          if ('serviceWorker' in navigator && 'SyncManager' in window) {
              navigator.serviceWorker.ready.then(function (reg) {
                  return reg.sync.register('notifier-reseau');
                  
              });
          };
        }
        
        // function meNotifier() {
        //   Notification.requestPermission().then(function (result) {
        //       console.log("permission donnée");
        //       console.log(result);
        //   });
        // }
        </script>
</body>
</html>